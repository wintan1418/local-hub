databases:
  - name: localservicehub-db
    databaseName: localservicehub_production
    user: localservicehub
    region: oregon

services:
  - type: web
    name: localservicehub
    runtime: ruby
    plan: free
    buildCommand: bundle install && bundle exec rails assets:precompile && bundle exec rails db:migrate
    startCommand: bundle exec puma -t 5:5 -p $PORT -e production
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: localservicehub-db
          property: connectionString
      - key: RAILS_MASTER_KEY
        sync: false
      - key: SECRET_KEY_BASE
        generateValue: true
      - key: RAILS_ENV
        value: production
      - key: BUNDLE_WITHOUT
        value: development:test
      # Payment processing (Stripe) - optional
      - key: STRIPE_PUBLISHABLE_KEY
        sync: false
      - key: STRIPE_SECRET_KEY
        sync: false
      - key: STRIPE_WEBHOOK_SECRET
        sync: false
      # SMS/WhatsApp integration (Twilio) - optional
      - key: TWILIO_ACCOUNT_SID
        sync: false
      - key: TWILIO_AUTH_TOKEN
        sync: false
      - key: TWILIO_PHONE_NUMBER
        sync: false
      - key: TWILIO_WHATSAPP_NUMBER
        sync: false
      # App configuration
      - key: APP_HOST
        value: localservicehub.onrender.com
      - key: APP_NAME
        value: LocalServiceHub
      # Database configuration
      - key: RAILS_MAX_THREADS
        value: "5"
      - key: RAILS_LOG_LEVEL
        value: info
    region: oregon
    branch: main